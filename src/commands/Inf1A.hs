{-# LANGUAGE OverloadedStrings #-}

module Inf1A (sendHDocChan, sendBoolChan, sendTextbookChan, sendSylChan) where

import Discord.Types
import Discord
import Utils
    ( captureCommandOutput, sendMessageChan, sendFileChan, captureUnsafeCommandOutput, isRoleID)
import qualified Data.Text as T
import UnliftIO (liftIO)

sendSylChan :: ChannelId -> DiscordHandler (Either RestCallErrorCode Message)
sendSylChan chan = sendFileChan chan "id-smash-aristotle.png"
                                     "./src/assets/cl/syllogisms.png"

sendBoolChan :: ChannelId -> DiscordHandler (Either RestCallErrorCode Message)
sendBoolChan chan = sendFileChan chan "literally-satan.png"
                                      "./src/assets/cl/Bool.png"

sendTextbookChan :: ChannelId -> DiscordHandler (Either RestCallErrorCode Message)
sendTextbookChan chan = sendFileChan chan "the-holy-bible-2.png"
                                          "./src/assets/textbooks/i1a-textbook.pdf"

sendHDocChan :: Message -> T.Text -> ChannelId -> DiscordHandler (Either RestCallErrorCode Message)
sendHDocChan m q c = do
    isDev <- isRoleID m 813562407523844106
    if isDev then do
        x <- liftIO $ captureUnsafeCommandOutput $ "hoogle search --info" ++ T.unpack q
        sendMessageChan c x
    else do  
        let x = "This function is currently only allowed for OwenDevs"  
        sendMessageChan c x 